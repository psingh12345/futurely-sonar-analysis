{% extends 'base_admin.html' %}
{% load stu_tags %}
{% load admin_tags %}
{% load static %}
{% load i18n %}
{% load phrase_i18n %}
{% load widget_tweaks %}
{% block title %}
<title>Futurely: AI Comments </title>
{% endblock %}
{% block style %}
{% phrase_javascript %}
<link rel="icon" href="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/website/images/favicon.png">
<link rel="canonical" href="https://beta.myfuturely.com/it/counselor/dashboard/" />
<!-- <link rel="canonical" href="https://beta.myfuturely.com/en/counselor/dashboard/" /> -->
<link rel="canonical" href="https://beta.myfuturely.com/counselor/dashboard/" />

<link rel="alternate" href="https://beta.myfuturely.com/it/counselor/dashboard/" hreflang="en-it" />
<link rel="alternate" href="https://beta.myfuturely.com/it/counselor/dashboard/" hreflang="es-it" />
<link rel="alternate" href="https://beta.myfuturely.com/it/counselor/dashboard/" hreflang="fr-it" />
<link rel="alternate" href="https://beta.myfuturely.com/it/counselor/dashboard/" hreflang="it-it" />
<link rel="alternate" href="https://beta.myfuturely.com/it/counselor/dashboard/" hreflang="it" />
<link rel="alternate" href="https://beta.myfuturely.com/counselor/dashboard/" hreflang="en-us" />
<link rel="alternate" href="https://beta.myfuturely.com/counselor/dashboard/" hreflang="x-default" />
<meta http-equiv="content-language" content="it, it-it, en-it, es-it, fr-it" />
<!-- new font called-->
<link
    href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,300;0,400;0,500;0,700;0,900;1,300;1,400;1,500;1,700;1,900&display=swap"
    rel="stylesheet">

<link href="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/theme_style.css"
    rel="stylesheet">
<link href="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/dataTables.bootstrap4.min.css"
    rel="stylesheet">
<link href="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/style.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<link rel="stylesheet" href="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/style_auth.css">
<link href="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/export/plugins.min.css" rel="stylesheet"
    type="text/css" />
<link href="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/export/buttons.dataTables.min.css"
    rel="stylesheet" type="text/css" />

<style>
    .moderation-page-block {
        width: 100%;
        display: block;
        border-radius: 8px;
        background: #19191C;
        padding: 40px;
    }

    .moderation-inner-block {
        width: 100%;
        display: block;
        max-width: 920px;
    }

    .moderation-main-title-block {
        color: #FFF;
        font-size: 36px;
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        line-height: normal;
        margin-bottom: 28px;
    }

    .moderation-inner-card {
        display: flex;
        width: 100%;
        padding: 16px;
        flex-direction: column;
        align-items: flex-start;
        flex-wrap: wrap;
        gap: 8px;
        border-radius: 8px;
        background: #FFF;
    }

    .moderation-inner-card+.moderation-inner-card {
        margin-top: 16px;
    }

    .moderation-inner-card .h2 span {
        font-size: 14px;
        font-style: normal;
        font-weight: 400;
    }

    .moderation-inner-card .h2 {
        color: #000;
        font-size: 24px;
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        line-height: 40px;
        margin: 0;
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        gap: 32px;
    }

    .moderation-inner-card .h3 {
        color: #000;
        text-align: center;
        font-size: 18px;
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        margin: 0;
        line-height: 40px;
    }

    .moderation-inner-card p {
        color: #000;
        font-size: 14px;
        font-family: Roboto;
        font-style: normal;
        font-weight: 400;
        line-height: normal;
        margin: 0;
        word-break: break-word;
    }

    .moderation-button-group {
        display: flex;
        justify-content: space-between;
        align-items: center;
        align-self: stretch;
        flex-wrap: wrap;
    }

    .moderation-button-item {
        display: flex;
        padding: 12px 0px;
        justify-content: center;
        align-items: center;
        gap: 10px;
    }

    .moderation-button-item button {
        color: #000;
        font-size: 16px;
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        line-height: normal;
        text-decoration-line: underline;
        background: transparent;
        border: none;
        outline: none;
    }

    .moderation-button-link {
        display: flex;
        padding: 12px 24px;
        justify-content: center;
        align-items: center;
        gap: 10px;
        border-radius: 8px;
        border: 1px solid #B179F0;
        background: #B179F0;
        color: #FFF;
        font-size: 16px;
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        line-height: normal;
        transition: all .5s;
    }

    .moderation-transparent-button {
        border: 1px solid #000;
        background: transparent;
        color: #000;
    }

    .moderation-button-link:hover,
    .moderation-button-link:focus {
        background: #A87EE9;
        border-color: #A87EE9;
        color: #fff;
        box-shadow: 0px 0px 0px 4px rgba(78, 70, 180, 0.2);
    }

    .cancella-modal-popup .modal-content {
        width: 100%;
        border-radius: 8px;
        border: 2px solid #333437;
        background: #26272B;
        display: flex;
        flex-wrap: wrap;
        padding: 32px;
        flex-direction: column;
        align-items: center;
        gap: 24px;
    }

    .cancella-modal-popup .modal-header button {
        opacity: 1;
    }

    .cancella-modal-popup .modal-header {
        text-align: right;
        margin-left: auto;
    }

    .cancella-modal-popup .modal-body h3 {
        color: #FFF;
        text-align: center;
        font-size: 24px;
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        line-height: 40px;
        margin: 0;
    }

    .cancella-modal-popup .modal-body {
        display: flex;
        flex-wrap: wrap;
        width: 100%;
        padding: 24px;
        flex-direction: column;
        align-items: center;
        gap: 8px;
    }

    .cancella-modal-popup .modal-footer {
        display: flex;
        width: 100%;
        justify-content: space-between;
        align-items: flex-start;
        flex-shrink: 0;
        flex-wrap: wrap;
        padding: 0;
    }

    .cancella-modal-btn-secondary {
        display: flex;
        padding: 12px 24px;
        justify-content: center;
        align-items: center;
        gap: 10px;
        border-radius: 8px;
        border: 1px solid #FFF;
        background: transparent;
        color: #FFF;
        font-size: 16px;
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        line-height: normal;
    }

    .cancella-modal-btn-primary {
        display: flex;
        padding: 12px 24px;
        justify-content: center;
        align-items: center;
        gap: 10px;
        border-radius: 8px;
        background: #B179F0;
        border: 1px solid #B179F0;
        color: #FFF;
        font-size: 16px;
        font-family: Roboto;
        font-style: normal;
        font-weight: 500;
        line-height: normal;
    }

    @media (max-width:767px) {
        .moderation-page-block {
            padding: 20px;
        }

        .moderation-main-title-block {
            font-size: 26px;
            margin-bottom: 18px;
        }

        .moderation-inner-card .h2 {
            font-size: 22px;
            line-height: 28px;
            gap: 0;
        }

        .moderation-inner-card .h3 {
            line-height: 28px;
        }

        .moderation-button-link {
            padding: 10px 15px;
        }

        .cancella-modal-popup .modal-content {
            padding: 12px;
            gap: 15px;
        }

        .cancella-modal-popup .modal-body h3 {
            font-size: 18px;
            line-height: 28px;
        }

        .cancella-modal-popup .modal-body {
            padding: 15px;
            gap: 8px;
        }

        .cancella-modal-btn-primary {
            padding: 10px 15px;
        }
    }


    /* middle school and fast track button */
        :root {
        --gray-500: #6B7280;
        --gray-700: #374151;
        }

        .school-button {
        display: flex;
        height: 28px;
        padding: 6px 16px;
        justify-content: center;
        align-items: center;
        border-radius: 6px;
        border: 0.5px solid var(--gray-500, #6B7280);
        background: var(--gray-700, #374151);
        color: white;
        font-size: 14px;
        font-weight: bold;
        text-transform: uppercase;
        cursor: pointer;
        outline: none;
        }

        .card-container {
        display: flex;
        padding: 24px;
        align-items: center;
        gap: 16px;
        }

        .card {
        border-radius: 8px;
        border: 20px solid rgba(84, 84, 84, 0.29);
        background: #26272B;
        box-shadow: 0px 4px 4px 0px rgba(0, 0, 0, 0.25);
        color: white
        /* Add additional styles for the card here (e.g., width, height, text color, etc.) */
        }
        /* Add new css */
        .moderation-page-block .card {
            border: none;
            padding: 15px;
        }
        .moderation-inner-boxe {
            border-radius: 8px;
            border: 2px solid #333437;
            background: #26272B;
            padding: 16px;
        }
        .moderation-inner-card p[contenteditable="true"] {
            border: 2px solid #333437;
            border-radius: 8px;
            padding: 10px;
            transition: all .5s;
        }
        .moderation-button-item button.moderation-button-link.submit-button:hover {
            border: 1px solid #000;
            background: transparent;
            color: #000;
            box-shadow: none;
        }
        .pagination-frame {
            display: flex;
            align-items: center;
            gap: 4px;
            justify-content: center;
            margin: 38px 0;
        }
        .pagination-textt .pagination-tabs {
        color: #FFF;
        text-align: center;
        font-feature-settings: 'clig' off, 'liga' off;
        font-family: Roboto;
        font-size: 14px;
        font-style: normal;
        font-weight: 400;
        line-height: 24px;
        width: 32px;
        height: 32px;
        padding: 4px 8px;
        margin: 0 2px;
        display: inline-block;
    }
        .pagination-textt .pagination-tabs.current {
        border-radius: 8px;
        background: #B179F0;
    }
    .moderation-page-block .card-container {
        padding-left: 0;
        padding-right: 0;
    }

</style>
{% endblock%}
{% block content %}
<div class="main-content py-4">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="moderation-page-block">
                    <!-- <h2 class="moderation-main-title-block">Risposte al “Diario di bordo” </h2> -->
                    <div class="card-container">
                        <div class="card">AI comments(Total): {{ total_ai_comments }}</div>
                        <div class="card">AI Generated comments(New) : {{ total_ai_generated_comments }}</div>
                        <div class="card">Total AI comments(Published): {{ total_ai_published_comments }}</div>
                        <div class="card">Total AI comments(Modified): {{ total_ai_modified_published_comments }}</div>
                        <div class="card">Total AI comments(Cancelled): {{total_ai_cancelled_comments}}</div>
                      </div>                      
                    
                    <div class="moderation-inner-block" id="cards_container">
                        <div class="moderation-inner-boxe">
                        <div class="moderation-divider-block">
                            <div class="row">
                                <div class="col-md-9">
                                    <h2 class="moderation-main-title-block">Risposte al “Diario di bordo”</h2>
                                </div>
                                <div class="col-md-3">
                                    <select id="school-filter" class="form-select" aria-label="Default select example">
                                        <option value="all" {% if school_program == 'all' %}selected{% endif %}>All</option>
                                        <option value="from_middle_school" {% if school_program == 'from_middle_school' %}selected{% endif %}>Middle School</option>
                                        <option value="from_fast_track_program" {% if school_program == 'from_fast_track_program' %}selected{% endif %}>Fast track</option>
                                    </select>
                                </div>
                                
                            </div>
                        </div>
                        {% for ai_comment_obj in ai_generated_comments %}
                        <div class="moderation-inner-card">
                            <h3 class="h2">Scheda studente <span>{{ai_comment_obj.student_actions_item_diary_id.action_item_track.step_tracker.stu_cohort_map.student.username}}</span>
                                {% if ai_comment_obj.student_actions_item_diary_id.action_item_track.step_tracker.stu_cohort_map.student.student.is_from_middle_school %}
                                    <button class="school-button">Middle School</button>
                                {% else%}
                                    <button class="school-button">Fast track</button>
                                {% endif %}    
                            </h3>
                            <h4 class="h3">Step
                                {{ai_comment_obj.student_actions_item_diary_id.action_item_track.step_tracker.step_status_id.step.step_sno}},
                                Domanda {{ai_comment_obj.student_actions_item_diary_id.action_item_diary.sno}}</h4>
                            <p>{{ai_comment_obj.student_actions_item_diary_id.action_item_diary.question}}</p>
                            <h4 class="h3">Risposta dello studente</h4>
                            <p>{{ai_comment_obj.student_actions_item_diary_id.answer}}</p>
                        </div>
                        <div class="moderation-inner-card">
                            <h3 class="h2">Risposta automatica</h3>
                            <p id="ai_data_{{ forloop.counter }}" contentEditable="false">
                                {{ai_comment_obj.ai_comment}}<br>
                            </p>
                            <div class="moderation-button-group">
                                <div class="moderation-button-item modal-button">
                                    <button type="button" id="cancella-button-{{ forloop.counter }}"
                                        data-bs-toggle="modal" class="cancella-btn" data-bs-target="#cancella-modal"
                                        data-pk="{{ai_comment_obj.id}}">Cancella</button>

                                </div>
                                <div class="moderation-button-item">
                                    <button class="moderation-button-link submit-button" type="submit"
                                        onclick="publish_modify_ai_records({{ai_comment_obj.id}},'Modified',{{forloop.counter}})"
                                        style="display: none;">Modified Published</button>
                                    <a class="moderation-button-link moderation-transparent-button"
                                        onclick="toggleEdit({{ forloop.counter }})">
                                        Modifica</a>
                                    <a class="moderation-button-link"
                                        onclick="publish_modify_ai_records({{ai_comment_obj.id}},'Published',{{forloop.counter}})">Pubblica</a>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                        
                    <!--<div class="pagination" style="color: white;">
                        <span class="step-links">
                          {% if ai_generated_comments.has_previous %}
                            <a href="?page={{ ai_generated_comments.previous_page_number }}">Previous</a>
                          {% endif %}
                          <span class="current">
                            Page {{ ai_generated_comments.number }} of {{ ai_generated_comments.paginator.num_pages }}.
                          </span>
                          {% if ai_generated_comments.has_next %}
                            <a href="?page={{ ai_generated_comments.next_page_number }}">Next</a>
                          {% endif %}
                        </span>
                   </div>-->
                   
                   <div class="pagination-frame">
                    {% if ai_generated_comments.has_previous %}
                        <a href="?page={{ ai_generated_comments.previous_page_number }}">
                            <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M14.75 16.5L10.25 12L14.75 7.5" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
                                <rect x="1" y="0.5" width="23" height="23" rx="7.5" stroke="white"/>
                            </svg>
                        </a>
                    {% endif %}
                
                    <div class="pagination-textt">
                        {% for page_num in ai_generated_comments.paginator.page_range %}
                            {% if page_num == ai_generated_comments.number %}
                                <a href="#" class="pagination-tabs current">{{ page_num }}</a>
                            {% else %}
                                <a href="?page={{ page_num }}" class="pagination-tabs">{{ page_num }}</a>
                            {% endif %}
                        {% endfor %}
                    </div>
                
                    {% if ai_generated_comments.has_next %}
                        <a href="?page={{ ai_generated_comments.next_page_number }}">
                            <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10.25 7.5L14.75 12L10.25 16.5" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>
                                <rect x="1" y="0.5" width="23" height="23" rx="7.5" stroke="white"/>
                            </svg>
                        </a>
                    {% endif %}
                </div>                
                       
                </div>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

<!-- Modal -->
<div class="modal fade cancella-modal-popup" id="cancella-modal" tabindex="-1" aria-labelledby="cancella-modalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h3> Sei sicuro/a che non vuoi rispondere a questo diario?</h3>
            </div>
            <div class="modal-footer">
                <button type="button" class="cancella-modal-btn-secondary"  data-bs-dismiss="modal">No</button>
                <button type="button" class="cancella-modal-btn-primary"
                    id="cancellaRispostaBtn">Cancella la risposta</button>
            </div>
        </div>
    </div>
</div>

<!-- change country popup -->
<div class="modal fade change-country-popup" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"
    id="changecountryModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" id="hidecountrypopup" class="btn-close cross-btn-cls" data-bs-dismiss="modal"
                    aria-label="Close"></button>
                <h5 class="modal-title">Seleziona la nazione</h5>
            </div>
            <div class="modal-body">
                <div class="flag-country-block">
                    <a href="/set-lang/?lang=it&u=https://beta.myfuturely.com/counselor/dashboard/">
                        <img
                            src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/website/new/images/italy-flag-icon.png" />
                        <h4>ITALY</h4>
                    </a>
                </div>
                <div class="flag-country-block">
                    <a href="/set-lang/?lang=en&u=https://beta.myfuturely.com/counselor/dashboard/">
                        <img
                            src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/website/new/images/usa-flag-icon.png" />
                        <h4>USA</h4>
                    </a>
                </div>
                <div class="flag-country-block">
                    <a href="/set-lang/?lang=en&u=https://beta.myfuturely.com/counselor/dashboard/">
                        <p>Altro</p>
                    </a>
                </div>
            </div>
            <div class="modal-footer">
                <p>*Puoi cambiare nazione ogni volta che vorrai in fondo alla pagina*</p>
            </div>
        </div>
    </div>
</div>
<!-- change country popup -->

<div class="modal fade learn-popup" id="PCTO" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="btn-close cross-btn-cls" data-bs-dismiss="modal"
                    aria-label="Close"></button>
            </div>
            <div class="modal-body pctodiv">
                <p>Se sei interessato a vedere riconosciute le tue ore PCTO ma la tua scuola non conosce Futurely,
                    saremo felici di aiutarti. Scrivici una mail con i contatti della tua scuola a
                    <u>segreteria@myfuturely.com</u>
                </p>
                <p>Informa il tuo referente PCTO, lo contatteremo a tuo nome per poter avere un colloquio e
                    presentarci.</p>
                <p>Ancora nessuna scuola ha rifiutato a nessun ragazzo il riconoscimento di queste ore!</p>
            </div>
        </div>
    </div>
</div>
<!-- Logout Modal-->
<div class="modal fade" id="logoutModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Pronto a partire?</h5>
                <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                Seleziona “Logout” qui sotto se vuoi terminare la sessione corrente</div>
            <div class="modal-footer">
                <button class="btn btn-secondary" type="button" data-dismiss="modal">Cancel</button>
                <a class="btn btn-primary" href="/logout/">Logout</a>
            </div>
        </div>
    </div>
</div>

{% endblock %}
{% block script %}
<script src="https://use.fontawesome.com/05a4a6d46a.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/apexcharts.min.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/apexcharts.data.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/popper.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/jquery.blockui.min.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/jquery.slimscroll.js"></script>
<!-- bootstrap -->
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/bootstrap.min.js"></script>
<script
    src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/bootstrap-switch.min.js"></script>
<!-- data tables -->
<script
    src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/jquery.dataTables.min.js"></script>
<script
    src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/dataTables.bootstrap4.min.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/table_data.js"></script>
<!-- Common js-->
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/app.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/layout.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/theme-color.js"></script>
<!-- Material -->
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/new_css/material.min.js"></script>

<!-- Export -->
<script
    src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/export/dataTables.buttons.min.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/export/buttons.flash.min.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/export/jszip.min.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/export/pdfmake.min.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/export/vfs_fonts.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/export/buttons.html5.min.js"></script>
<script src="https://futurely-beta-static-files.s3.eu-south-1.amazonaws.com/css/export/buttons.print.min.js"></script>

<script>
    function publish_modify_ai_records(id, ai_comment_type,index) {
        // const ai_modified_data = document.getElementById("ai_data_" + id).textContent
        const elementId = "ai_data_" + index;
        const ai_element = document.getElementById(elementId);
        let ai_modified_data;

        if (ai_element) {
            ai_modified_data = ai_element.textContent;
        } else {
            ai_modified_data = "none";
        }
        $.ajax({
            type: "POST",
            url: "{% url 'publish_modify_ai_records' %}",
            headers: { "X-CSRFToken": "{{ csrf_token }}" },
            data: { 'id': id, 'ai_comment_type': ai_comment_type, 'ai_modified_data': ai_modified_data },
            success: function (response) {
                window.location.reload()
            },
            error: function (response) {
                console.log(response)
            }
        })
    }
</script>
<script>
    function toggleEdit(index) {
        const paragraph = document.getElementById('ai_data_' + index);
        const editButton = document.getElementsByClassName('moderation-transparent-button')[index - 1];
        const submitButton = document.getElementsByClassName('submit-button')[index - 1];

        if (paragraph) {
            if (paragraph.getAttribute('contentEditable') === 'true') {
                paragraph.setAttribute('contentEditable', 'false');
                submitButton.style.display = 'none';
                editButton.textContent = 'Modifica';
            } else {
                // Enable edit mode
                paragraph.setAttribute('contentEditable', 'true');
                submitButton.style.display = 'inline';
                editButton.textContent = 'close';

            }
        }
    }

</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var cancelButtons = document.querySelectorAll(".cancella-btn");
        var obj_pk; 
        cancelButtons.forEach(function (cancelButton) {
            cancelButton.addEventListener("click", function (event) {
                debugger
                obj_pk = event.target.dataset.pk;
                $("#cancellaRispostaBtn").on("click", function () {
                    debugger
                    $.ajax({
                        type: "POST",
                        url: "{% url 'remove_ai_record' %}",
                        headers: { "X-CSRFToken": "{{ csrf_token }}" },
                        data: { 'id': obj_pk},
                        success: function (response) {
                            window.location.reload()
                        },
                        error : function(response){
                            console.log(response)
                        }
                    })
                });
            });
        });
    });

</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const dropdown = document.getElementById("school-filter");
        dropdown.addEventListener("change", function() {
            const selectedValue = dropdown.value;
            const url = "{% url 'filter_ai_generated_comments' 'value_placeholder' %}".replace('value_placeholder', selectedValue);
            window.location.href = url;
        });
    });
</script>

<!-- <script>
    document.getElementById('school-filter').addEventListener('change', filterCards);
    function filterCards() {
        var selectedValue = document.getElementById('school-filter').value;
        var cards = document.querySelectorAll('.moderation-inner-card');
        for (var i = 0; i < cards.length; i += 2) {
            var studentCard = cards[i];
            var schoolButton = studentCard.querySelector('.school-button');
            if (schoolButton) {
                var isMiddleSchool = schoolButton.textContent === 'Middle School';
                var isFastTrack = schoolButton.textContent === 'Fast track';
                var responseCard = cards[i + 1];
                if (selectedValue === 'all') {
                    studentCard.style.display = '';
                    responseCard.style.display = ''; 
                } else if (selectedValue === 'middle') {
                    studentCard.style.display = isMiddleSchool ? '' : 'none';
                    responseCard.style.display = isMiddleSchool ? '' : 'none'; // Show only middle school cards
                } else if (selectedValue === 'fast') {
                    studentCard.style.display = isFastTrack ? '' : 'none';
                    responseCard.style.display = isFastTrack ? '' : 'none'; // Show only fast track cards
                }
            }
        }
    }
</script> -->


    

{% endblock %}